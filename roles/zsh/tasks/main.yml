---

- name: install zsh
  apt: pkg=zsh state=latest update_cache=yes cache_valid_time={{ aptcachetime }}

- name: clone oh-my-zsh repo
  git:
    repo: https://github.com/robbyrussell/oh-my-zsh.git
    dest: "{{ ansible_env.HOME }}/.oh-my-zsh"

- name: clone zsh-syntax-highlighting
  git:
    repo: https://github.com/zsh-users/{{ item }}.git
    dest: "{{ ansible_env.HOME }}/.oh-my-zsh/custom/plugins/{{ item }}"
    update: no
  loop: "{{ zsh_users_plugins }}"

- name: clone powerlevel9k
  git:
    repo: https://github.com/bhilburn/powerlevel9k.git
    dest: "{{ ansible_env.HOME }}/.oh-my-zsh/themes/powerlevel9k"

- name: copy .zshrc to $HOME
  template:
    src: zshrc.j2
    dest: "/home/{{ user }}/.zshrc"
    owner: "{{ ansible_env.USER }}"
    group: "{{ ansible_env.USER }}"

- name: copy fonts
  copy:
    src: fonts/
    dest: "{{ ansible_env.HOME }}/.local/share/fonts/"
    owner: "{{ ansible_env.USER }}"
    group: "{{ ansible_env.USER }}"

- name: Set monospace-font-name
  command: "gsettings set org.gnome.desktop.interface monospace-font-name 'NotoMono Nerd Font Mono Bold 11'"
  become_user: "{{ ansible_env.USER }}"

- name: Change shell to ZSH
  user:
    name: "{{ ansible_env.USER }}"
    shell: /bin/zsh
